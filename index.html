<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>M.O.L: Maze of Labubu</title>
    <style>
        /* 保持你截图里的粉嫩简约感 */
        :root { --pink: #ff477e; --bg: #f8f0ff; }
        body { margin: 0; background: var(--bg); font-family: -apple-system, sans-serif; display: flex; flex-direction: column; align-items: center; height: 100vh; overflow: hidden; }
        
        /* 顶部 HUD 1:1 还原你截图的效果 */
        .hud { width: 90%; margin-top: 15px; padding: 15px; background: rgba(255,255,255,0.8); backdrop-filter: blur(10px); border-radius: 24px; display: flex; justify-content: space-around; box-shadow: 0 4px 20px rgba(0,0,0,0.05); }
        .hud-item { text-align: center; }
        .hud-val { display: block; font-weight: bold; color: var(--pink); font-size: 1.1rem; }
        .hud-label { font-size: 0.6rem; color: #999; text-transform: uppercase; }

        #game-view { flex: 1; display: flex; align-items: center; justify-content: center; width: 100%; }
        canvas { border: 8px solid white; border-radius: 32px; background: #fff; box-shadow: 0 10px 40px rgba(0,0,0,0.08); }

        /* 虚拟按键还原你截图的样式 */
        .controls { display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; margin-bottom: 40px; }
        .joy-btn { width: 60px; height: 60px; background: white; border-radius: 20px; border: none; font-size: 1.4rem; color: var(--pink); box-shadow: 0 4px 12px rgba(0,0,0,0.05); cursor: pointer; display: flex; align-items: center; justify-content: center; }
        .joy-btn:active { transform: scale(0.95); background: #fff1f5; }

        /* 初始隐藏菜单 */
        .overlay { position: fixed; inset: 0; background: rgba(255,255,255,0.9); backdrop-filter: blur(20px); z-index: 100; display: flex; flex-direction: column; align-items: center; justify-content: center; }
        .logo-text { font-size: 4rem; color: var(--pink); font-weight: 900; letter-spacing: -3px; margin: 0; }
        .start-btn { margin-top: 30px; background: var(--pink); color: white; border: none; padding: 18px 60px; border-radius: 40px; font-weight: bold; font-size: 1.2rem; box-shadow: 0 10px 25px rgba(255,71,126,0.3); }
    </style>
</head>
<body>

    <div class="hud">
        <div class="hud-item"><span class="hud-label">LEVEL</span><span id="lvD" class="hud-val">1</span></div>
        <div class="hud-item"><span class="hud-label">TIME</span><span id="tmD" class="hud-val">00:00</span></div>
        <div class="hud-item"><span class="hud-label">HERO</span><span id="hrD" class="hud-val">心动粉</span></div>
    </div>

    <div id="game-view"><canvas id="mainCvs"></canvas></div>

    <div class="controls">
        <div></div><button class="joy-btn" onclick="move('u')">↑</button><div></div>
        <button class="joy-btn" onclick="move('l')">←</button>
        <button class="joy-btn" onclick="move('d')">↓</button>
        <button class="joy-btn" onclick="move('r')">→</button>
    </div>

    <div id="startLayer" class="overlay">
        <h1 class="logo-text">M.O.L</h1>
        <p style="color:#999; letter-spacing:4px">MAZE OF LABUBU</p >
        <button class="start-btn" onclick="startGame()">GO ADVENTURE!</button>
    </div>

<script>
    const cvs = document.getElementById('mainCvs');
    const ctx = cvs.getContext('2d');
    
    // 重点：角色图片对象
    const heroImg = new Image();
    // 你可以把这里的 URL 换成你自己抠出来的透明 Labubu PNG 图片地址
    heroImg.src = 'https://img.icons8.com/color/96/monster-icon.png'; 

    let state = { level: 1, seconds: 0 };
    let maze, player, rows, size;

    function startGame() {
        document.getElementById('startLayer').style.display = 'none';
        initMaze();
        setInterval(() => {
            state.seconds++;
            const m = Math.floor(state.seconds/60).toString().padStart(2,'0');
            const s = (state.seconds%60).toString().padStart(2,'0');
            document.getElementById('tmD').innerText = `${m}:${s}`;
        }, 1000);
    }

    function initMaze() {
        let b = 7 + state.level;
        rows = b % 2 === 0 ? b + 1 : b;
        const dS = Math.min(window.innerWidth * 0.85, 400);
        cvs.width = cvs.height = dS;
        size = dS / rows;
        maze = Array.from({length:rows},()=>Array(rows).fill(1));
        
        const walk = (x, y) => {
            maze[x][y] = 0;
            [[0,2],[0,-2],[2,0],[-2,0]].sort(()=>Math.random()-0.5).forEach(([dx,dy])=>{
                if(x+dx>0 && x+dx<rows-1 && y+dy>0 && y+dy<rows-1 && maze[x+dx][y+dy]==1){
                    maze[x+dx/2][y+dy/2]=0; walk(x+dx, y+dy);
                }
            });
        };
        walk(1,1); player = {x:1, y:1};
        draw();
    }

    function draw() {
        ctx.clearRect(0,0,cvs.width,cvs.height);
        for(let x=0;x<rows;x++){
            for(let y=0;y<rows;y++){
                if(maze[x][y]==1){ 
                    ctx.fillStyle="#fff1f5"; // 迷宫墙壁颜色
                    ctx.fillRect(y*size, x*size, size, size); 
                }
                if(x==rows-2&&y==rows-2){ 
                    ctx.fillStyle="#fbbf24"; // 终点金色
                    ctx.fillRect(y*size+size*0.2, x*size+size*0.2, size*0.6, size*0.6); 
                }
            }
        }
        // 使用图片绘制角色，完美还原质感
        ctx.drawImage(heroImg, player.y*size, player.x*size, size, size);
    }

    window.move = (d) => {
        let nx=player.x, ny=player.y;
        if(d=='u')nx--; if(d=='d')nx++; if(d=='l')ny--; if(d=='r')ny++;
        if(maze[nx] && maze[nx][ny]==0){
            player.x=nx; player.y=ny; draw();
            if(nx==rows-2 && ny==rows-2) {
                state.level++; 
                document.getElementById('lvD').innerText = state.level;
                initMaze();
            }
        }
    };
</script>
</body>
</html>
